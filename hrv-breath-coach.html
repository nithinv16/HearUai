<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRV Breath Coach - HearuAI</title>
    <link rel="stylesheet" href="css/hrv-breath-coach.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <button class="back-btn" onclick="window.history.back()">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1>HRV Breath Coach</h1>
            <button class="settings-btn" id="settingsBtn">
                <i class="fas fa-cog"></i>
            </button>
        </header>

        <main class="main-content">
            <!-- HRV Status Section -->
            <section class="hrv-status">
                <div class="status-card">
                    <div class="status-header">
                        <h2>Current HRV Status</h2>
                        <div class="connection-status" id="connectionStatus">
                            <i class="fas fa-circle"></i>
                            <span>Disconnected</span>
                        </div>
                    </div>
                    <div class="hrv-metrics">
                        <div class="metric">
                            <div class="metric-value" id="hrvValue">--</div>
                            <div class="metric-label">HRV (ms)</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="heartRate">--</div>
                            <div class="metric-label">Heart Rate</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="coherenceScore">--</div>
                            <div class="metric-label">Coherence</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Camera PPG Section -->
            <section class="camera-ppg">
                <div class="ppg-card">
                    <h3>Camera-Based Heart Rate Detection</h3>
                    <div class="camera-container">
                        <video id="cameraVideo" autoplay muted></video>
                        <canvas id="ppgCanvas" style="display: none;"></canvas>
                        <div class="camera-overlay">
                            <div class="finger-guide">
                                <i class="fas fa-hand-paper"></i>
                                <p>Place finger over camera lens</p>
                            </div>
                        </div>
                    </div>
                    <div class="ppg-controls">
                        <button class="btn-primary" id="startPPGBtn">
                            <i class="fas fa-play"></i>
                            Start Detection
                        </button>
                        <button class="btn-secondary" id="stopPPGBtn" style="display: none;">
                            <i class="fas fa-stop"></i>
                            Stop Detection
                        </button>
                    </div>
                    <div class="ppg-signal">
                        <canvas id="signalCanvas" width="300" height="100"></canvas>
                    </div>
                </div>
            </section>

            <!-- Breathing Guide Section -->
            <section class="breathing-guide">
                <div class="guide-card">
                    <h3>Breathing Exercise</h3>
                    <div class="breathing-visualizer">
                        <div class="breath-circle" id="breathCircle">
                            <div class="breath-text" id="breathText">Ready</div>
                        </div>
                    </div>
                    <div class="breathing-controls">
                        <div class="exercise-selector">
                            <label for="exerciseType">Exercise Type:</label>
                            <select id="exerciseType">
                                <option value="4-7-8">4-7-8 Breathing</option>
                                <option value="box">Box Breathing</option>
                                <option value="coherent">Coherent Breathing</option>
                                <option value="custom">Custom Pattern</option>
                            </select>
                        </div>
                        <div class="duration-selector">
                            <label for="exerciseDuration">Duration:</label>
                            <select id="exerciseDuration">
                                <option value="2">2 minutes</option>
                                <option value="5" selected>5 minutes</option>
                                <option value="10">10 minutes</option>
                                <option value="15">15 minutes</option>
                            </select>
                        </div>
                        <button class="btn-primary" id="startBreathingBtn">
                            <i class="fas fa-play"></i>
                            Start Exercise
                        </button>
                        <button class="btn-secondary" id="stopBreathingBtn" style="display: none;">
                            <i class="fas fa-stop"></i>
                            Stop Exercise
                        </button>
                    </div>
                    <div class="exercise-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="time-remaining" id="timeRemaining">5:00</div>
                    </div>
                </div>
            </section>

            <!-- HRV Trends Section -->
            <section class="hrv-trends">
                <div class="trends-card">
                    <h3>HRV Trends & Insights</h3>
                    <div class="trend-chart">
                        <canvas id="trendChart" width="350" height="200"></canvas>
                    </div>
                    <div class="insights-grid">
                        <div class="insight-item">
                            <div class="insight-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="insight-content">
                                <h4>Weekly Average</h4>
                                <p id="weeklyAverage">42.3 ms</p>
                            </div>
                        </div>
                        <div class="insight-item">
                            <div class="insight-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="insight-content">
                                <h4>Best Session</h4>
                                <p id="bestSession">Yesterday, 8:30 PM</p>
                            </div>
                        </div>
                        <div class="insight-item">
                            <div class="insight-icon">
                                <i class="fas fa-target"></i>
                            </div>
                            <div class="insight-content">
                                <h4>Coherence Goal</h4>
                                <p id="coherenceGoal">85% achieved</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Wearable Integration Section -->
            <section class="wearable-integration">
                <div class="integration-card">
                    <h3>Wearable Device Integration</h3>
                    <div class="device-grid">
                        <div class="device-item">
                            <div class="device-icon">
                                <i class="fab fa-apple"></i>
                            </div>
                            <div class="device-info">
                                <h4>Apple Watch</h4>
                                <p class="device-status">Not Connected</p>
                            </div>
                            <button class="connect-btn" data-device="apple">Connect</button>
                        </div>
                        <div class="device-item">
                            <div class="device-icon">
                                <i class="fas fa-heartbeat"></i>
                            </div>
                            <div class="device-info">
                                <h4>Polar H10</h4>
                                <p class="device-status">Not Connected</p>
                            </div>
                            <button class="connect-btn" data-device="polar">Connect</button>
                        </div>
                        <div class="device-item">
                            <div class="device-icon">
                                <i class="fas fa-watch"></i>
                            </div>
                            <div class="device-info">
                                <h4>Fitbit</h4>
                                <p class="device-status">Not Connected</p>
                            </div>
                            <button class="connect-btn" data-device="fitbit">Connect</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Settings Modal -->
        <div class="modal" id="settingsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>HRV Settings</h3>
                    <button class="close-btn" onclick="closeModal('settingsModal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="setting-group">
                        <label for="measurementInterval">Measurement Interval:</label>
                        <select id="measurementInterval">
                            <option value="30">30 seconds</option>
                            <option value="60" selected>1 minute</option>
                            <option value="120">2 minutes</option>
                            <option value="300">5 minutes</option>
                        </select>
                    </div>
                    <div class="setting-group">
                        <label for="coherenceThreshold">Coherence Threshold:</label>
                        <input type="range" id="coherenceThreshold" min="0.5" max="2.0" step="0.1" value="1.0">
                        <span id="coherenceValue">1.0</span>
                    </div>
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="enableNotifications" checked>
                            Enable HRV Notifications
                        </label>
                    </div>
                    <div class="setting-group">
                        <label>
                            <input type="checkbox" id="enableVibration" checked>
                            Enable Vibration Feedback
                        </label>
                    </div>
                    <div class="setting-group">
                        <label for="dataRetention">Data Retention:</label>
                        <select id="dataRetention">
                            <option value="7">7 days</option>
                            <option value="30" selected>30 days</option>
                            <option value="90">90 days</option>
                            <option value="365">1 year</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeModal('settingsModal')">Cancel</button>
                    <button class="btn-primary" onclick="saveSettings()">Save Settings</button>
                </div>
            </div>
        </div>

        <!-- Custom Breathing Pattern Modal -->
        <div class="modal" id="customPatternModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Custom Breathing Pattern</h3>
                    <button class="close-btn" onclick="closeModal('customPatternModal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="pattern-inputs">
                        <div class="input-group">
                            <label for="inhaleTime">Inhale (seconds):</label>
                            <input type="number" id="inhaleTime" min="1" max="10" value="4">
                        </div>
                        <div class="input-group">
                            <label for="holdTime">Hold (seconds):</label>
                            <input type="number" id="holdTime" min="0" max="10" value="4">
                        </div>
                        <div class="input-group">
                            <label for="exhaleTime">Exhale (seconds):</label>
                            <input type="number" id="exhaleTime" min="1" max="10" value="4">
                        </div>
                        <div class="input-group">
                            <label for="pauseTime">Pause (seconds):</label>
                            <input type="number" id="pauseTime" min="0" max="10" value="0">
                        </div>
                    </div>
                    <div class="pattern-preview">
                        <h4>Pattern Preview</h4>
                        <div class="preview-circle" id="previewCircle">
                            <span id="previewText">Preview</span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" onclick="closeModal('customPatternModal')">Cancel</button>
                    <button class="btn-primary" onclick="saveCustomPattern()">Save Pattern</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/hrv-breath-coach.js"></script>
</body>
</html>